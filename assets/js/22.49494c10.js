(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{203:function(s,n,e){"use strict";e.r(n);var a=e(0),t=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[e("strong",[s._v("js是单线程，除了依靠函数调用栈来搞定函数的执行顺序外，还依靠任务队列(task queue)来搞定另外一些代码的执行。")])]),s._v(" "),e("ul",[e("li",[s._v("一个线程中，事件循环是唯一的，但是任务队列可以拥有多个。")]),s._v(" "),e("li",[s._v("任务队列又分为macro-task（宏任务）与micro-task（微任务），在最新标准中，它们被分别称为task与jobs。")]),s._v(" "),e("li",[s._v("macro-task大概包括：script(整体代码), setTimeout, setInterval, setImmediate, I/O, UI rendering。")]),s._v(" "),e("li",[s._v("micro-task大概包括: process.nextTick, Promise, Object.observe(已废弃), MutationObserver(html5新特性)")])]),s._v(" "),e("p",[s._v("例子1")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('var r = new Promise(function(resolve, reject){\n    console.log("a");\n    resolve()\n});\nsetTimeout(()=>console.log("d"), 0)\nr.then(() => console.log("c"));\nconsole.log("b")\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("例子2")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('var r = new Promise(function(resolve, reject){\n    console.log("a");\n    resolve()\n});\nsetTimeout(()=>console.log("d"), 0)\nr.then(() => console.log("c"));\nconsole.log("b")\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("例子3")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('setTimeout(()=>console.log("d"), 0)\nvar r = new Promise(function(resolve, reject){\n    resolve()\n});\nr.then(() => { \n    var begin = Date.now();\n    while(Date.now() - begin < 1000);\n    console.log("c1") \n    new Promise(function(resolve, reject){\n        resolve()\n    }).then(() => console.log("c2"))\n});\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[s._v("例子4")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('function sleep(duration) {\n    return new Promise(function(resolve, reject) {\n        console.log("b");\n        setTimeout(resolve,duration);\n    })\n}\nconsole.log("a");\nsleep(5000).then(()=>console.log("c"));\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("总结")]),s._v(" "),e("ul",[e("li",[s._v("首先我们分析有多少个宏任务；")]),s._v(" "),e("li",[s._v("在每个宏任务中，分析有多少个微任务；")]),s._v(" "),e("li",[s._v("根据调用次序，确定宏任务中的微任务执行次序；")]),s._v(" "),e("li",[s._v("根据宏任务的触发规则和调用次序，确定宏任务的执行次序；")]),s._v(" "),e("li",[s._v("确定整个顺序。")])])])}),[],!1,null,null,null);n.default=t.exports}}]);